<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>プレビュー</title>
    <link rel="stylesheet" href="styles.css"> 
    <link rel="stylesheet" href="error.css">
    <!-- 外部CSSファイルとエラー用のCSSを読み込む -->
    <!-- 最初にアイコンと拡大アニメーションのスタイルを追加 -->
 

</head>
<body>
 <!-- 残りの元々のHTMLコード -->
    <audio id="pasteSound" src="paste.mp3" preload="auto"></audio>

    <div id="startScreen">
        <textarea id="htmlInput" class="resizable closed" placeholder="HTMLコードを入力...(Return/Enterを押して反映)"></textarea>
        <div class="Dock">
            <div class="container">
                <label class="switch">
                    <span class="label-text">HTMLを入力</span>
                    <input type="checkbox" id="change_toggle">
                    <span class="slider"></span>
                    <!-- コピー ボタンの隣に HTML タグボタンを配置 -->
                    <button class="copy-button" onclick="copyText()">コピー</button>
                    <button class="normal-button" id="htmlTagsBtn">+</button>
                    <button class="normal-button" button id="insertBtn">!</button>
                </label>
            </div>
        </div><br>
        <textarea id="cssInput" class="resizable closed" placeholder="CSSコードを入力..."></textarea>
        <button id="cssToggle" class="toggle">CSS入力を書き換え</button>
        <textarea id="jsInput" class="resizable closed" placeholder="JavaScriptコードを入力..."></textarea>
        <button id="jsToggle" class="toggle">JavaScript入力を書き換え</button>
        <div class="button-container">
            <button id="expandBtn" class="expand-btn">拡大</button>
            <button id="reloadBtn" class="expand-btn">反映&読み込み</button> <!-- 追加 -->
            <button id="copyDownloadBtn" class="copy-download-btn">＋ コピー</button>
            <button id="resetBtn" class="reset-btn">削除する</button>
            <div class="overlay" id="htmlTagsMenu">
                <div class="html-tags-content">
                    <h2>　タグを追加</h2>
                    <ul id="tagList">
                        <!-- 既存のHTMLタグ一覧 -->
                        <li onclick="insertTag('')"><button>&lt;h1&gt; - ホームページ</button></li>
                        <li onclick="insertTag('')"><button>&lt;h2&gt; - サブタイトル</button></li>
                        <li onclick="insertTag('')"><button>&lt;h3&gt; - 見出し</button></li>
                        <li onclick="insertTag('')"><button> &lt;h1&gt;・&lt;h4&gt; - h1とh4</button></li>
                        <li onclick="insertTag()"><button>&lt;p&gt; - 文字</button></li>
                        <li onclick="insertTag('')"><button>&lt;b&gt; - 太文字</button></li>
                        <li onclick="insertTag('')"><button>&lt;u&gt; - 下線</button></li>
                        <li onclick="insertTag('')"><button>&lt;span&gt; - 文字色変更</button></li>
                        <li onclick="insertTag('')"><button>&lt;a&gt; - ハイパーリンク</button></li>
                        <li id="otherButton" onclick="toggleOtherTags()"><button id="otherButtonText">その他</button></li>
                    </ul>
                    <button class="undo-button" onclick="closeTagMenu()">htmlを入力に戻る</button>
                </div>
            </div>
            <div class="copy-notification" id="copyNotification"></div>
        </div>
    </div>    

<!-- iframe内のフォント環境設定-->
    <script src="font.js"></script>

<!--古いWebブラウザの場合。-->
    <div class="Dockcontainer" id="message-container">
        <h1 style="font-size: 85px;">⊗</h1>
        <h1>全ての機能を使うには<br> ブラウザのアップデートが必要です。</h1>
   
        <p>ブラウザをアップデートするか、以前のデバイスの場合、</p>
        <p>最新のGoogle Chromeから起動してください。</p>
      </div>
      <script src="error.js"></script>


    <!-- JavaScriptコード（アイコンのクリック処理） -->
    <script>
  

        let htmlTagsMenu = document.getElementById('htmlTagsMenu');
        let htmlTagsBtn = document.getElementById('htmlTagsBtn');
        let tagList = document.getElementById('tagList');
        let copyNotification = document.getElementById('copyNotification');
        let otherButton = document.getElementById('otherButton');
        let otherButtonText = document.getElementById('otherButtonText');
        let isOtherTagsActive = false;  // 「その他」タグがアクティブかどうか
    
        // コピー済みタグを追跡するための Set
        let copiedTags = new Set();
    
        // タグメニュー表示
        htmlTagsBtn.addEventListener('click', function() {
            // メニュー表示
            htmlTagsMenu.style.display = 'flex';
            setTimeout(() => {
                htmlTagsMenu.style.opacity = '1';
                htmlTagsMenu.style.transform = 'scale(1)';
                let items = tagList.getElementsByTagName('li');
                Array.from(items).forEach((item, index) => {
                    setTimeout(() => {
                        item.classList.add('show');
                    }, index * 50); // 0.05秒間隔で表示
                });
            }, 50);
    
            // 「その他」タグがアクティブなら切り替え
            if (isOtherTagsActive) {
                toggleOtherTags();
            }
        });
    
        // 外部クリックでメニューを閉じる
        window.addEventListener('click', function(e) {
            if (!htmlTagsMenu.contains(e.target) && e.target !== htmlTagsBtn) {
                closeTagMenu();
            }
        });
    
        // Escapeキーでメニューを閉じる
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeTagMenu();
            }
        });
    
        // タグ挿入関数
        function insertTag(tag) {
            let htmlInput = document.getElementById('htmlInput').value;
    
            // すでに同じタグが存在するかチェック
            const regex = new RegExp(tag.replace(/[.*+?^=!:${}()|\[\]\/\\]/g, '\\$&'), 'g');
            if (htmlInput.match(regex)) {
                
            }
    
            // 新しいタグを追加
            document.getElementById('htmlInput').value += tag;
            showCopyNotification(tag);
        }

    
        // メニューを閉じる
        function closeTagMenu() {
            let items = tagList.getElementsByTagName('li');
            Array.from(items).forEach(item => item.classList.remove('show'));
            htmlTagsMenu.style.opacity = '0';
            htmlTagsMenu.style.transform = 'scale(0.8)';
            setTimeout(() => {
                htmlTagsMenu.style.display = 'none';
                // 「その他」状態で閉じた場合は切り替えをリセット
                if (isOtherTagsActive) {
                    toggleOtherTags();
                }
            }, 300);
        }
    
        // その他タグの切り替え
        function toggleOtherTags() {
            if (isOtherTagsActive) {
                // その他タグを戻す
                document.querySelectorAll('li').forEach((li, index) => {
                    if (index === 0) li.innerHTML = '<button>&lt;h1&gt; - ホームページ</button>';
                    if (index === 1) li.innerHTML = '<button>&lt;h2&gt; - サブタイトル</button>';
                    if (index === 2) li.innerHTML = '<button>&lt;h3&gt; - 見出し</button>';
                    if (index === 3) li.innerHTML = '<button>&lt;h1&gt;・&lt;h4&gt; - h1とh4</button>';
                    if (index === 4) li.innerHTML = '<button>&lt;p&gt; - 文字</button>';
                    if (index === 5) li.innerHTML = '<button>&lt;b&gt; - 太文字</button>';
                    if (index === 6) li.innerHTML = '<button>&lt;u&gt; - 下線</button>';
                    if (index === 7) li.innerHTML = '<button>&lt;span&gt; - 文字色変更</button>';
                    if (index === 8) li.innerHTML = '<button>&lt;a&gt; - ハイパーリンク</button>';
                });
                otherButtonText.innerHTML = 'その他';
                otherButton.classList.remove('other-button-active');
            } else {
                // その他タグに切り替え
                document.querySelectorAll('li').forEach((li, index) => {
                    if (index === 0) li.innerHTML = '<button>&lt;meter&gt; - 評価スコア</button>';
                    if (index === 1) li.innerHTML = '<button>&lt;del&gt; - 取り消し線</button>';
                    if (index === 2) li.innerHTML = '<button>&lt;mark&gt; - 強調表示</button>';
                    if (index === 3) li.innerHTML = '<button>&lt;h5&gt; - 小さい文字</button>';
                    if (index === 4) li.innerHTML = '<button>&lt;span&gt; - 文字サイズ指定</button>';
                    if (index === 5) li.innerHTML = '<button>&lt;marquee&gt; - 右から左</button>';
                    if (index === 6) li.innerHTML = '<button>&lt;hr&gt; - 区切り線</button>';
                    if (index === 7) li.innerHTML = '<button>&lt;h6&gt; - 超小さい文字</button>';
                    if (index === 8) li.innerHTML = '<button>&lt;br&gt; - 改行</button>';
                });
                otherButtonText.innerHTML = '戻す';
                otherButton.classList.add('other-button-active');
            }
            isOtherTagsActive = !isOtherTagsActive;
        }
    
        // 各タグボタンのクリックイベント
        document.querySelectorAll('li').forEach((li) => {
            li.addEventListener('click', () => {
                let tag = li.textContent.trim();
    
                // 「その他」状態の場合、選ばれたタグだけをコピー
                if (isOtherTagsActive) {
                    switch (tag) {
                        case '<meter> - 評価スコア':
                            insertTag('<meter value="80" min="0" max="100"></meter>'); break;
                        case '<del> - 取り消し線':
                            insertTag('<del>取り消し線のあるテキスト</del>'); break;
                        case '<mark> - 強調表示':
                            insertTag('<mark>強調表示</mark>'); break;
                        case '<h5> - 小さい文字':
                            insertTag('<h5>小さい文字</h5>'); break;
                        case '<span> - 文字サイズ指定':
                            insertTag('<p><span style="font-size: 24px;">文字サイズを24pxに変更した文字</span></p>'); break;
                        case '<marquee> - 右から左':
                            insertTag('<marquee>みぎからひだりに</marquee>'); break;
                        case '<hr> - 区切り線':
                            insertTag('<hr> <!-- 水平線 -->'); break;
                        case '<h6> - 超小さい文字':
                            insertTag('<h6>超小さい文字</h6>'); break;
                        case '<br> - 改行':
                            insertTag('<br>'); break;
                        default:
                            break;
                    }
                    // コピー済みタグに追加
                    copiedTags.add(tag);
                } else {
                    // 通常のタグ群のコピー
                    switch (tag) {
    case '<h1> - ホームページ':
        // 改行とインデントを含んだHTMLコード
        var htmlContent = `

<html>
<head>
    <meta charset="UTF-8">
    <title>サイト名</title>
</head>
<body>
    <header>
        <h1>サンプルWebページ</h1>
    </header>

    <ul>
        <li><a href="#home">ホーム</a></li>
        <li><a href="#contact">お問い合わせ</a></li>
    </ul>

    <main>
        <section id="home">
            <h2>・ホーム</h2>
            <p>ここはホームセクションです。簡単な紹介文を記載します。</p>
                <img src="image.png" alt="サンプル画像" class="sample-image" style="width: 50%; height: auto;">
        </section>

        <section id="contact">
            <h2>・お問い合わせ</h2>
            <p>お問い合わせセクションです。ご連絡は以下の方法でお願いします。</p>
        </section>
    </main>

    <footer>
        <h3>フッター（最下部）</h3>
    </footer>
</body>
</html>
`;  // テンプレートリテラルで改行を保持

        // insertTag関数を使ってコピー
        insertTag(htmlContent);
        break;
                        case '<h2> - サブタイトル':
                            insertTag('<h2>サブタイトル</h2>'); break;
                        case '<h3> - 見出し':
                            insertTag('<h3>見出し</h3>'); break;
                        case '<h1>・<h4> - h1とh4':
                            insertTag('<h1>タイトル</h1> <h4>小さい見出し</h4>'); break;
                        case '<p> - 文字':
                            insertTag('<p>文字を入力...</p>'); break;
                        case '<b> - 太文字':
                            insertTag('<b>太文字</b>'); break;
                        case '<u> - 下線':
                            insertTag('<u>下線</u>'); break;
                        case '<span> - 文字色変更':
                            insertTag('<span style="color: red;">赤文字</span>'); break;
                        case '<a> - ハイパーリンク':
                            insertTag('<a href="URL">ハイパーリンク</a>'); break;
                        default:
                            break;
                    }
                }
            });
        });

        // コピー通知の要素
const CopyNotification = document.createElement('div');
copyNotification.classList.add('copy-notification');
document.body.appendChild(copyNotification);

// コピー通知の表示
function showCopyNotification(tag) {
    copyNotification.textContent = `コピー・${tag}`;
    copyNotification.style.opacity = '1';
    setTimeout(() => {
        copyNotification.style.opacity = '0';
    }, 700); // 0.7秒後にフェードアウト
}


// 取り消し通知の表示
function showUndoNotification() {
    copyNotification.textContent = '取り消し';
    copyNotification.style.opacity = '1';
    setTimeout(() => {
        copyNotification.style.opacity = '0';
    }, 700); // 0.7秒後にフェードアウト
}

// ペースト通知の表示
function showPasteNotification() {
    copyNotification.textContent = 'ペースト';
    copyNotification.style.opacity = '1';
    setTimeout(() => {
        copyNotification.style.opacity = '0';
    }, 700); // 0.7秒後にフェードアウト
}

// キーボードイベントリスナー
document.addEventListener('keydown', function (e) {
    // Cmd+Z または Ctrl+Z を検出
    if ((e.ctrlKey || e.metaKey) && e.key === 'z') {
        showUndoNotification(); // 取り消し通知を表示
    }
    // Cmd+V または Ctrl+V を検出
    else if ((e.ctrlKey || e.metaKey) && e.key === 'v') {
        showPasteNotification(); // ペースト通知を表示
    }
});




// コピー通知の表示関数
function showCopyNotification(action, content = '') {
    copyNotification.textContent = `${action}${content ? ': ' + content : ''}`;
    copyNotification.style.opacity = '1';
    setTimeout(() => {
        copyNotification.style.opacity = '0';
    }, 700); // 0.7秒後にフェードアウト
}



// 例：コピー操作を模倣
function copyText(tag) {
    // 実際のコピー処理がここに来る
    showCopyNotification(tag); // コピー通知を表示
}

// 実際のコピー操作を模倣するボタンなどのイベントを追加する場合は
// 例えば、ボタンをクリックした時にコピー通知を表示させるなど。
document.getElementById('copy-button').addEventListener('click', () => {
    copyText('タグ名');
});

    </script>
    
</div>

        
        <iframe id="preview"></iframe>
        <div id="preview-overlay" class="preview-overlay"></div>
    </div>

    <div class="blur-overlay" id="blurOverlay">
        <div class="copy-options" id="copyOptions">
            <h3>コピーするコードを選択</h3>
            <button class="copy-btn" id="copyHtml" style="background-color: white;">HTMLをコピー</button>
            <button class="copy-btn" id="copyCss" style="background-color: white;">CSSをコピー</button>
            <button class="copy-btn" id="copyJs" style="background-color: rgb(255, 255, 255);">Scriptをコピー</button>
            
            <button class="close-options-btn" id="closeOptions"　style="background-color: rgba(255, 0, 60, 0.86);">閉じる</button>
        </div>
    </div>

    <script>

        const htmlInput = document.getElementById('htmlInput');
        const cssInput = document.getElementById('cssInput');
        const jsInput = document.getElementById('jsInput');
        const preview = document.getElementById('preview');
        const overlay = document.getElementById('preview-overlay');
        const copyDownloadBtn = document.getElementById('copyDownloadBtn');
        const blurOverlay = document.getElementById('blurOverlay');
        const copyOptions = document.getElementById('copyOptions');
        const toggle = document.getElementById('change_toggle');
        const slider = document.querySelector('.slider');
    
        
        // 初期状態でチェックされている場合に入力フィールドを表示
        if (toggle.checked) {
            slider.classList.remove('off');
            htmlInput.classList.remove('closed');
        }

        toggle.addEventListener('change', function() {
            if (toggle.checked) {
                slider.style.backgroundColor = '#4CAF50';  // オン時は緑色
                slider.classList.remove('off');  // 赤色を解除
                htmlInput.classList.remove('closed');  // 入力エリアを表示
                htmlInput.style.height = '250px';  // 高さ280pxで表示
                htmlInput.style.opacity = 1;  // 入力エリアを表示
            } else {
                slider.style.backgroundColor = '#242424';  // 入力なしの場合、灰色
                slider.classList.remove('off');  // 赤色解除
                if (htmlInput.value.trim() !== "") {
                    slider.classList.add('off');  // 入力がある場合は赤色
                    slider.style.backgroundColor = '#ff0000'; // 赤色に設定
                }
                htmlInput.classList.add('closed');  // 入力エリアを非表示
                htmlInput.style.height = '0';  // 高さを0にして閉じる
                htmlInput.style.opacity = 0;  // 透明にして閉じる
            }
    
        });

        // 入力がある場合にトグルの色を赤に変える
        htmlInput.addEventListener('input', function() {
            if (!toggle.checked && htmlInput.value.trim() !== "") {
                slider.classList.add('off');  // 入力ありでオフの場合、赤色に変更
                slider.style.backgroundColor = '#ff0000';  // 赤色に設定
            } else if (!toggle.checked && htmlInput.value.trim() === "") {
                slider.style.backgroundColor = '#ccc';  // 入力がない場合は灰色
                slider.classList.remove('off');
            }
        });
        
        function updatePreview() {
            const html = htmlInput.value;
            const css = cssInput.value;
            const js = jsInput.value;

            const doc = preview.contentDocument || preview.contentWindow.document;
            doc.open();
            doc.write(`
                <html>
            
                <head>
                    <style>${css}</style>
                </head>
                <body>
                
                    ${html}
                    <script>${js}<\/script>
                </body>
                </html>
            `);
            doc.close();
        }

        function toggleInput(input) {
            input.classList.toggle('closed');
            if (input.classList.contains('closed')) {
                input.style.height = '0';
                input.style.padding = '0';
                input.style.opacity = '0';
            } else {
                input.style.height = '200px';
                input.style.padding = '10px';
                input.style.opacity = '1';
            }
            updatePreview();
        }

        document.getElementById('reloadBtn').addEventListener('click', () => {
    updatePreview(); // プレビューを再読み込みする関数を呼び出し
});


        function handleFileDrop(event, input, validTypes) {
            event.preventDefault();
            const files = event.dataTransfer.files;
            const validFiles = Array.from(files).filter(file => validTypes.includes(file.type));

            if (validFiles.length > 0) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    input.value = e.target.result;
                    updatePreview();

                    // ここで音を再生
            const pasteSound = document.getElementById('pasteSound');
            pasteSound.play();  // 音を再生
                };
                reader.readAsText(validFiles[0]);
            } else {
                shakeInput(input);
            }
        }

        function shakeInput(input) {
            input.style.animation = 'shake 0.5s';
            setTimeout(() => {
                input.style.animation = ''; 
            }, 500);
        }

        function handleDragOver(event, input) {
            event.preventDefault();
            const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
            input.style.backgroundColor = isDarkMode ? 'rgba(255, 255, 255, 0.42)' : 'rgba(0, 0, 0, 0.7)';
            input.style.transform = 'scale(1.05)';
            input.style.transition = 'transform 0.5s ease';
        }

        function handleDragLeave(event, input) {
            input.style.backgroundColor = '';
            input.style.transform = 'scale(1)';
        }

        htmlInput.addEventListener('dragover', (event) => handleDragOver(event, htmlInput));
        htmlInput.addEventListener('dragleave', (event) => handleDragLeave(event, htmlInput));
        htmlInput.addEventListener('drop', (event) => {
            handleFileDrop(event, htmlInput, ['text/html']);
            handleDragLeave(event, htmlInput);
        });

        cssInput.addEventListener('dragover', (event) => handleDragOver(event, cssInput));
        cssInput.addEventListener('dragleave', (event) => handleDragLeave(event, cssInput));
        cssInput.addEventListener('drop', (event) => {
            handleFileDrop(event, cssInput, ['text/css']);
            handleDragLeave(event, cssInput);
        });

        jsInput.addEventListener('dragover', (event) => handleDragOver(event, jsInput));
        jsInput.addEventListener('dragleave', (event) => handleDragLeave(event, jsInput));
        jsInput.addEventListener('drop', (event) => {
            handleFileDrop(event, jsInput, ['application/javascript', 'text/javascript', 'text/plain']);
            handleDragLeave(event, jsInput);
        });

       
       
    

        document.getElementById('cssToggle').addEventListener('click', () => {
            toggleInput(cssInput);
        });
        document.getElementById('jsToggle').addEventListener('click', () => {
            toggleInput(jsInput);
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
    if (confirm("全て削除しますか？ (はい、いいえ)")) {
        htmlInput.value = '';
        cssInput.value = '';
        jsInput.value = '';
        updatePreview();

        // 各入力ボックスのリセット
        [htmlInput, cssInput, jsInput].forEach(input => {
            input.style.height = '200px';
            input.style.padding = '10px';
            input.style.opacity = '1';
            input.classList.remove('closed');
        });

        // iframe の位置とサイズをリセット
        const iframe = document.querySelector('iframe');
        iframe.style.width = '100%';
        iframe.style.height = '300px';
        iframe.style.marginTop = '40px';
        iframe.style.marginBottom = '45px';
    }
});


        document.getElementById('expandBtn').addEventListener('click', () => {
            const isExpanded = preview.classList.toggle('preview-expanded');
            overlay.style.display = isExpanded ? 'block' : 'none';
            if (isExpanded) {
                updatePreview();
            } else {
                overlay.style.display = 'none';
            }
        });

        overlay.addEventListener('click', () => {
            const isExpanded = preview.classList.contains('preview-expanded');
            if (isExpanded) {
                preview.classList.remove('preview-expanded');
                overlay.style.display = 'none';
            }
        });

        document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') {
        if (copyOptions.style.display === 'block') {
            closeCopyOptions(); // 閉じる処理を呼び出す
        } else if (preview.classList.contains('preview-expanded')) {
            preview.classList.remove('preview-expanded');
            overlay.style.display = 'none';
        }
    }
});

copyDownloadBtn.addEventListener('click', () => {
    blurOverlay.style.display = 'flex';
    copyOptions.style.display = 'block';
    copyOptions.classList.add('animate'); // アニメーションを適用するためのクラス
    copyOptions.style.opacity = '1'; // 不透明度を1に
});



        document.body.addEventListener('dblclick', (e) => {
            if (!e.target.closest('button, textarea, .toggle')) {
                preview.classList.toggle('preview-expanded');
                overlay.style.display = preview.classList.contains('preview-expanded') ? 'block' : 'none';
            }
        });


      // コピー通知の要素を作成

// コピー通知の表示関数
function showCopyNotification(tag) {
    copyNotification.textContent = `コピー・${tag}`;
    copyNotification.style.opacity = '1';
    setTimeout(() => {
        copyNotification.style.opacity = '0';
    }, 700); // 0.7秒後にフェードアウト
}

// HTMLのコピー処理
document.getElementById('copyHtml').addEventListener('click', () => {
    navigator.clipboard.writeText(htmlInput.value).then(() => {
        // 音を再生
        const pasteSound = document.getElementById('pasteSound');
        pasteSound.play();
        
        // コピー通知を表示
        showCopyNotification('HTML');
    });
});

// コピー処理
function copyText() {
            navigator.clipboard.writeText(htmlInput.value).then(() => {
        // コピー通知を表示
        showCopyNotification('HTML');
    });
};

// CSSのコピー処理
document.getElementById('copyCss').addEventListener('click', () => {
    navigator.clipboard.writeText(cssInput.value).then(() => {
        // 音を再生
        const pasteSound = document.getElementById('pasteSound');
        pasteSound.play();
        
        // コピー通知を表示
        showCopyNotification('CSS');
    });
});

// JavaScriptのコピー処理
document.getElementById('copyJs').addEventListener('click', () => {
    navigator.clipboard.writeText(jsInput.value).then(() => {
        // 音を再生
        const pasteSound = document.getElementById('pasteSound');
        pasteSound.play();
        
        // コピー通知を表示
        showCopyNotification('JavaScript');
    });
});


// blurOverlayとcopyOptionsのフェードアウトを行う関数
function closeCopyOptions() {
    // `copyOptions`にフェードアウトアニメーションを追加
    copyOptions.classList.add('fade-out');
    
    // `blurOverlay`にフェードアウトアニメーションを追加
    blurOverlay.classList.add('fade-out');
    
    // アニメーションが完了するタイミング（500ms後）で処理を実行
    setTimeout(() => {
        // `blurOverlay`を非表示にする
        blurOverlay.style.display = 'none'; 
        
        // `copyOptions`を非表示にする
        copyOptions.style.display = 'none'; 
        
        // フェードアウトアニメーションのクラスを削除
        copyOptions.classList.remove('fade-out');
        blurOverlay.classList.remove('fade-out');
    }, 500); // 500ms（アニメーションの時間）
}


// この部分を削除して以下を追加
document.getElementById('closeOptions').addEventListener('click', closeCopyOptions);




const reloadBtn = document.getElementById('reloadBtn');

// 再読み込み通知を表示する要素を作成
const reloadNotification = document.createElement('div');
reloadNotification.className = 'reload-notification';
reloadNotification.innerText = '再読み込み中...';
document.body.appendChild(reloadNotification);

let isLoading = false; // ローディング中のフラグ
let hideTimeout; // hideTimeoutをグローバルで管理して、前回のsetTimeoutをキャンセルする

reloadBtn.addEventListener('click', () => {
    if (isLoading) return; // すでにローディング中の場合は何もしない
    isLoading = true; // ローディング開始

    // 通知がすでに表示されている場合は前回の非表示アニメーションをキャンセル
    if (hideTimeout) {
        clearTimeout(hideTimeout); // 前回の非表示タイマーをクリア
        reloadNotification.classList.remove('hide'); // hideクラスを削除してスライドダウンとフェードインを再開
    }

    // 通知を表示する（スライドイン + フェードイン）
    reloadNotification.classList.add('show'); // スライドダウンとフェードイン

    // 通知を一定時間後に非表示にする（スライドアップ + フェードアウト）
    hideTimeout = setTimeout(() => {
        reloadNotification.classList.add('hide'); // スライドアップしてフェードアウト
    }, 1200); // 通知を2秒間表示

    // 再読み込みの処理（仮）
    setTimeout(() => {
        isLoading = false; // ローディング完了
        updatePreview(); // プレビューを更新
    }, 1800); // 2.5秒後に再読み込み完了
});
// 703行からここまででreloadBtnの調整ができる。cssも直す

const inputField = document.querySelector('.input-field');

inputField.addEventListener('dragover', (event) => {
    event.preventDefault(); // デフォルトの動作を防ぐ
    inputField.classList.add('dragging'); // アニメーションを追加
});

inputField.addEventListener('dragleave', () => {
    inputField.classList.remove('dragging'); // アニメーションを削除
});

inputField.addEventListener('drop', (event) => {
    event.preventDefault(); // デフォルトの動作を防ぐ
    inputField.classList.remove('dragging'); // アニメーションを削除
    // ファイル処理のロジック
});

// HTMLタグメニューの表示
htmlTagsBtn.addEventListener('click', function() {
    // メニュー表示
    htmlTagsMenu.style.display = 'flex'; // メニューを表示
    setTimeout(() => {
        htmlTagsMenu.style.opacity = '1'; // メニューをフェードイン
        htmlTagsMenu.style.transform = 'scale(1)'; // メニューを元のサイズに戻す
        let items = tagList.getElementsByTagName('li');
        Array.from(items).forEach((item, index) => {
            setTimeout(() => {
                item.classList.add('show');
            }, index * 50); // 0.05秒間隔で表示
        });
    }, 50);
});

// 外部クリックでメニューを閉じる
window.addEventListener('click', function(e) {
    if (!htmlTagsMenu.contains(e.target) && e.target !== htmlTagsBtn) {
        closeTagMenu();
    }
});

// Escapeキーでメニューを閉じる
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeTagMenu();
    }
});

// タグ挿入関数
function insertTag(tag) {
    let htmlInput = document.getElementById('htmlInput').value;
    
    // 新しいタグを追加
    document.getElementById('htmlInput').value += tag;
    showCopyNotification(tag);
}

// メニューを閉じる関数
function closeTagMenu() {
    let items = tagList.getElementsByTagName('li');
    Array.from(items).forEach(item => item.classList.remove('show'));
    htmlTagsMenu.style.opacity = '0';
    htmlTagsMenu.style.transform = 'scale(0.8)';
    setTimeout(() => {
        htmlTagsMenu.style.display = 'none';
        isLoading = false; // ローディング完了
        updatePreview(); // プレビューを更新
    }, 300);
}

// その他タグの切り替え
function toggleOtherTags() {
    if (isOtherTagsActive) {
        // その他タグを戻す
        document.querySelectorAll('li').forEach((li, index) => {
            if (index === 0) li.innerHTML = '<button>&lt;h1&gt; - ホームページ</button>';
            if (index === 1) li.innerHTML = '<button>&lt;h2&gt; - サブタイトル</button>';
            if (index === 2) li.innerHTML = '<button>&lt;h3&gt; - 見出し</button>';
            if (index === 3) li.innerHTML = '<button>&lt;h1&gt;・&lt;h4&gt; - h1とh4</button>';
            if (index === 4) li.innerHTML = '<button>&lt;p&gt; - 文字</button>';
            if (index === 5) li.innerHTML = '<button>&lt;b&gt; - 太文字</button>';
            if (index === 6) li.innerHTML = '<button>&lt;u&gt; - 下線</button>';
            if (index === 7) li.innerHTML = '<button>&lt;span&gt; - 文字色変更</button>';
            if (index === 8) li.innerHTML = '<button>&lt;a&gt; - ハイパーリンク</button>';
        });
        otherButtonText.innerHTML = 'その他';
        otherButton.classList.remove('other-button-active');
    } else {
        // その他タグに切り替え
        document.querySelectorAll('li').forEach((li, index) => {
            if (index === 0) li.innerHTML = '<button>&lt;meter&gt; - 評価スコア</button>';
            if (index === 1) li.innerHTML = '<button>&lt;del&gt; - 取り消し線</button>';
            if (index === 2) li.innerHTML = '<button>&lt;mark&gt; - 強調表示</button>';
            if (index === 3) li.innerHTML = '<button>&lt;h5&gt; - 小さい文字</button>';
            if (index === 4) li.innerHTML = '<button>&lt;span&gt; - 文字サイズ指定</button>';
            if (index === 5) li.innerHTML = '<button>&lt;marquee&gt; - 右から左</button>';
            if (index === 6) li.innerHTML = '<button>&lt;hr&gt; - 区切り線</button>';
            if (index === 7) li.innerHTML = '<button>&lt;h6&gt; - 超小さい文字</button>';
            if (index === 8) li.innerHTML = '<button>&lt;br&gt; - 改行</button>';
        });
        otherButtonText.innerHTML = '戻す';
        otherButton.classList.add('other-button-active');
    }
    isOtherTagsActive = !isOtherTagsActive;
}



    </script>
    <script>
   document.querySelector("body").addEventListener("dragover", function(event) {
    event.preventDefault();
});

document.querySelector("body").addEventListener("drop", function(event) {
    event.preventDefault();

    const file = event.dataTransfer.files[0];
    console.log(file);
    if (file && file.type.match(/^image\//)) {
        // 背景画像のフェードイン・フェードアウト
        const reader = new FileReader();
        reader.onload = function(event) {
            // 画像を背景に設定する前にフェードアウト
            document.body.style.transition = 'background-image 0.3s ease-in-out, opacity 0.3s ease-in-out';
            document.body.style.opacity = 0;

            // 新しい背景画像をセットする
            setTimeout(function() {
                document.body.style.backgroundImage = `url(${event.target.result})`;

                // 背景画像の切り替え後にフェードイン
                setTimeout(function() {
                    document.body.style.opacity = 1;
                }, 50);  // 少し待ってからフェードイン
            }, 300);  // フェードアウトの時間と同じだけ待つ
        };
        reader.readAsDataURL(file);
    }
});
       </script>



<!-- html基本情報をペースト-->
<script> 
    const defaultHTML = `<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Webページのタイトル</title>
</head>
<body>
<h1>見出し</h1>
<p>テキストの例</p> 
<!-- bodyを編集してページを作成 -->
</body>
</html>`;

    let insertCount = 0;

    function insertHTML(replace = false) {
        const textInput = document.getElementById("htmlInput");
    
        insertCount++;
        
        if (insertCount > 1 && !replace) {
            const confirmReplace = confirm("テキストがすでにある場合があります。入力置き換えますか？");
            if (confirmReplace) {
                textInput.value = defaultHTML; // 上書き
            } else {
                textInput.value += "\n" + defaultHTML; // 追加
            }
        } else {
            textInput.value = defaultHTML;
        }
        
        // iframeを更新
        preview.srcdoc = textInput.value;

  
        // カーソルを <body> 内に移動
        moveCursorToBody();
    }

    function moveCursorToBody() {
        const textInput = document.getElementById("htmlInput");
        const bodyStart = textInput.value.indexOf("<body>") + "<body>\n".length;
        if (bodyStart !== -1) {
            textInput.setSelectionRange(bodyStart, bodyStart);
            textInput.focus();
        }
    }

    // `!` ボタン押下時
    document.getElementById("insertBtn").addEventListener("click", function() {
        insertHTML();
    });

    // `htmlInput` を監視
    document.getElementById("htmlInput").addEventListener("keydown", function(event) {
        if (event.key === "Enter") {
            const textInput = document.getElementById("htmlInput");
            const lines = textInput.value.split("\n");
            const lastLine = lines[lines.length - 1].trim();

            if (lastLine === "!") {
                event.preventDefault(); // 改行を防ぐ
                insertHTML();
            }
        }
    });

</script>

</body>
</html>
